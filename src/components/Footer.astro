---
import { getAllSponsors, getSponsorsWithPrizes } from '../lib/sponsors';
import { getAllTracksFromProjects, getTopProjects } from '../lib/awards';
import { extractSlugFromUrl } from '../lib/devfolio';

// Get sponsors with prizes (sorted by prize amount)
const sponsors = getSponsorsWithPrizes().slice(0, 12);

// Get all tracks
const tracks = getAllTracksFromProjects();

// Get top projects by prize amount
const topProjects = getTopProjects(10);

// Slugify function for track URLs
function slugify(track: string): string {
  return track
    .toLowerCase()
    .replace(/[&]/g, "and")
    .replace(/[^a-z0-9]+/g, "-")
    .replace(/^-|-$/g, "");
}
---

<footer class="border-t border-gray-800 bg-gray-950/50 pt-16 pb-8">
  <div class="mx-auto max-w-7xl px-6">
    <!-- Main footer content -->
    <div class="grid gap-10 sm:grid-cols-2 lg:grid-cols-5">
      <!-- About -->
      <div class="lg:col-span-1">
        <a href="/" class="font-display text-xl text-white">
          Zypherpunk
        </a>
        <p class="mt-3 text-sm leading-relaxed text-gray-400">
          Unofficial community archive of winning projects from the Zypherpunk Hackathon - the largest privacy-focused hackathon in crypto.
        </p>
        <div class="mt-4 flex gap-3">
          <a
            href="https://github.com/d4mr/zypherpunk-results"
            target="_blank"
            rel="noopener"
            class="flex h-9 w-9 items-center justify-center rounded-lg border border-gray-800 bg-gray-900 text-gray-400 transition-colors hover:border-gray-700 hover:text-white"
            title="View source on GitHub"
          >
            <svg class="h-4 w-4" viewBox="0 0 16 16" fill="currentColor">
              <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
          </a>
        </div>
      </div>

      <!-- Top Projects -->
      <div>
        <h3 class="mb-4 text-sm font-semibold uppercase tracking-wider text-white">
          Top Projects
        </h3>
        <ul class="space-y-2">
          {topProjects.map((project) => {
            const slug = extractSlugFromUrl(project.url);
            return (
              <li>
                <a
                  href={slug ? `/project/${slug}` : project.url}
                  class="text-sm text-gray-400 transition-colors hover:text-white"
                >
                  {project.name}
                </a>
              </li>
            );
          })}
        </ul>
      </div>

      <!-- Tracks -->
      <div>
        <h3 class="mb-4 text-sm font-semibold uppercase tracking-wider text-white">
          Tracks
        </h3>
        <ul class="space-y-2">
          {tracks.map((track) => (
            <li>
              <a
                href={`/track/${slugify(track)}`}
                class="text-sm text-gray-400 transition-colors hover:text-white"
              >
                {track.replace("Privacy-Preserving ", "").replace("Privacy-Focused ", "").replace(" & ", " / ")}
              </a>
            </li>
          ))}
        </ul>
      </div>

      <!-- Sponsors -->
      <div>
        <h3 class="mb-4 text-sm font-semibold uppercase tracking-wider text-white">
          Top Sponsors
        </h3>
        <ul class="space-y-2">
          {sponsors.map((sponsor) => (
            <li>
              <a
                href={`/sponsor/${sponsor.id}`}
                class="text-sm text-gray-400 transition-colors hover:text-white"
              >
                {sponsor.displayName}
              </a>
            </li>
          ))}
        </ul>
      </div>

      <!-- Resources -->
      <div>
        <h3 class="mb-4 text-sm font-semibold uppercase tracking-wider text-white">
          Resources
        </h3>
        <ul class="space-y-2">
          <li>
            <a
              href="https://zypherpunk.devfolio.co"
              target="_blank"
              rel="noopener"
              class="text-sm text-muted-foreground transition-colors hover:text-white"
            >
              Official Hackathon
            </a>
          </li>
          <li>
            <a
              href="https://z.cash"
              target="_blank"
              rel="noopener"
              class="text-sm text-muted-foreground transition-colors hover:text-white"
            >
              Zcash
            </a>
          </li>
          <li>
            <a
              href="https://devfolio.co"
              target="_blank"
              rel="noopener"
              class="text-sm text-muted-foreground transition-colors hover:text-white"
            >
              Devfolio
            </a>
          </li>
          <li>
            <a
              href="https://github.com/d4mr/zypherpunk-results"
              target="_blank"
              rel="noopener"
              class="text-sm text-muted-foreground transition-colors hover:text-white"
            >
              Source Code
            </a>
          </li>
        </ul>
      </div>
    </div>

    <!-- Disclaimer -->
    <div class="mt-12 rounded-lg border border-gray-800 bg-gray-900/50 px-4 py-3 text-center">
      <p class="text-xs leading-relaxed text-gray-400">
        This is an unofficial community archive. Not affiliated with <a href="https://zypherpunk.xyz" target="_blank" rel="noopener" class="text-gray-400 hover:text-white transition-colors">zypherpunk.xyz</a>, the hackathon organisers, or any sponsors.
        Data compiled from winner announcements in the official Discord server.
      </p>
    </div>

    <!-- Bottom bar -->
    <div class="mt-8 flex flex-col items-center justify-between gap-4 border-t border-gray-800/50 pt-8 sm:flex-row">
      <p class="text-sm text-gray-400">
        Project data from <a href="https://devfolio.co" target="_blank" rel="noopener" class="text-gray-300 hover:text-white transition-colors">Devfolio</a>
      </p>
      <p class="text-sm text-gray-400">
        Made by <a href="https://d4mr.com" target="_blank" rel="noopener" class="text-gray-300 hover:text-white transition-colors">d4mr</a>
      </p>
    </div>
  </div>
</footer>
